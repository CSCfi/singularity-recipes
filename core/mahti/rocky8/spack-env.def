Bootstrap: localimage
From: core.sif

%setup
    # Preserve symbolic links. Do NOT dereference.
    mkdir -p "$APPTAINER_ROOTFS/scratch/project_2014802/test/v1.1.0/core"
    cp -r -d /scratch/project_2014802/test/v1.1.0/core/gcc152_env "$APPTAINER_ROOTFS/scratch/project_2014802/test/v1.1.0/core/gcc152_env"

%environment
    # We need to generate and modify the environment variables using spack env activate as follows:
    # `env -i /projappl/project_2014802/spack/bin/spack env activate --sh -d /scratch/project_2014802/test/v1.1.0/core/gcc152_env/`
    export SPACK_ENV=/scratch/project_2014802/test/v1.1.0/core/gcc152_env;
    export SPACK_ENV_VIEW=default;
    export ACLOCAL_PATH=/scratch/project_2014802/test/v1.1.0/core/gcc152_env/views/share/aclocal:$ACLOCAL_PATH;
    export CMAKE_PREFIX_PATH=/scratch/project_2014802/test/v1.1.0/core/gcc152_env/views:$CMAKE_PREFIX_PATH;
    export MANPATH=/scratch/project_2014802/test/v1.1.0/core/gcc152_env/views/share/man:/scratch/project_2014802/test/v1.1.0/core/gcc152_env/views/man:$MANPATH;
    export PATH=/scratch/project_2014802/test/v1.1.0/core/gcc152_env/views/bin:$PATH;
    export PKG_CONFIG_PATH=/scratch/project_2014802/test/v1.1.0/core/gcc152_env/views/share/pkgconfig:/scratch/project_2014802/test/v1.1.0/core/gcc152_env/views/lib64/pkgconfig:/scratch/project_2014802/test/v1.1.0/core/gcc152_env/views/lib/pkgconfig:$PKG_CONFIG_PATH;
